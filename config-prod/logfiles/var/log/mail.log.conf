################################################################################
# File: logScanner/config/var/log/mail.log.conf                                #
# Created:     Jan-07-25                                                       #
# Last update: Jan-07-25                                                       #
################################################################################

# TAB caracters are used as delimiters.
# Do not begin or end regexps with (").  It breaks (some) SQL inserts.

# Information to extrat date from log line:
# std::string line = "2025-04-20T23:08:13.846546-04:00 mainmail postfix/smtpd[1183601]: disconnect from 2be65cda.tidalcoinage.internet-measurement.com[167.99.234.119] commands=0/0";

# Regexp to extract date:
# std::string regxFmt = "^([[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2})T([[:digit:]]{2}:[[:digit:]]{2}:[[:digit:]]{2})\\.[[:digit:]]{1,}-[[:digit:]].*";
R	^([[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2})T([[:digit:]]{2}:[[:digit:]]{2}:[[:digit:]]{2})\.[[:digit:]]{1,}-[[:digit:]].*
# std::vector<char> buildMap{1, ' ', 2};
# Only ONE character between commas!
M	1, ,2
# std::string format = "%Y-%m-%d %H:%M:%S";
F	%Y-%m-%d %H:%M:%S

# Regexps to select bad boys:
# severity-val	regexp
0	: improper command pipelining after CONNECT from .*\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]:
0	: warning: Connection concurrency limit exceeded:.* from .*\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]
0	: warning: non-SMTP command from .*\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]
0	: warning: .*\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]: [[:alnum:] -]{1,} authentication failed: [[:lower:] ]{1,}, sasl_username=root
0	: NOQUEUE: reject: RCPT from unknown\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]: .*: Relay access denied;
1	: NOQUEUE: reject: RCPT from [^[:space:]]{1,}\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]: .* <[^[:space:]]{1,}@[^[:space:]]{1,}\.[^[:space:]]{1,}>: Recipient address rejected:
1	: warning: .*\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]: [[:alnum:] -]{1,} authentication failed: [[:lower:] ]{1,}, sasl_username=((?!root))
1	: warning: hostname [^[:space:]]* does not resolve to address ([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}): No address associated with hostname
1	: connect from unknown\[([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]
3	imapd[[:lower:]-]*: LOGIN FAILED, [^[:space:]]*=.* ip=\[[[:alnum:]:]*[^[:alnum:]]([[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3})\]
#*END*#
